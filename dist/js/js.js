var sendMessage=chrome.runtime.sendMessage;function isXML(n){var t=n.documentElement,e=t&&"http://www.w3.org/2000/svg"===t.namespaceURI;return!(n instanceof HTMLDocument||e)}function toXml(n){var t=(new DOMParser).parseFromString(n,"application/xml");if(t&&t.documentElement&&"parsererror"!==t.documentElement.nodeName&&!t.getElementsByTagName("parsererror").length)return t;var e=t.getElementsByTagName("parsererror")[0];throw console.log(e),"<h2>Canâ€™t parse XML document</h2> \n"+(e?e.textContent:"")}function renderPage(n){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4===t.readyState&&(200===t.status||0===t.status))try{doTransform(toXml(t.responseText))}catch(n){console.log("Unable to render document: invalid XML"),console.error(n)}},t.open("GET",n,!0),t.send()}function canTransform(n){return!!n&&(1===n.nodeType&&(n=n.ownerDocument),"documentElement"in n&&isXML(n)&&!(n.documentElement instanceof HTMLElement))}var doSomeMagic=function(n){console.log(n),sendMessage({action:"msg.do-cool-stuff"},function(n){console.log("omg")})};function doTransform(u){sendMessage({action:"msg.get-html",filePath:"../html/html.html"},function(n){var t=(new DOMParser).parseFromString(n.fileText,"text/html");document.replaceChild(document.adoptNode(t.documentElement),document.documentElement),document.getElementsByTagName("link")[0].setAttribute("href",chrome.extension.getURL("css/css.css"));var e=document.implementation.createDocumentType("html","-//W3C//DTD XHTML 1.0 Transitional//EN","http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"),r=document.implementation.createDocument("http://www.w3.org/1999/xhtml","html",e),o=null;u instanceof Document?o=r.adoptNode(u.documentElement):(o=r.createDocumentFragment(),u.childNodes.forEach(function(n){o.appendChild(r.importNode(n,!0))})),r.replaceChild(o,r.documentElement),doSomeMagic(r)})}function togglePageAction(n){sendMessage({action:n?"msg.show-page-action":"msg.hide-page-action"})}"__canRender"in this||(this.__canRender=canTransform(document)),document.addEventListener("readystatechange",function(){if("complete"===document.readyState){var n=window.webkitIntent||window.intent;if(n){var t=n.getExtra?n.getExtra("url"):n.data[0].url;if(!t)return;return renderPage(t),void togglePageAction(!1)}var e=document&&document.getElementById("webkit-xml-viewer-source-xml");e?(e.parentNode.removeChild(e),doTransform(e),togglePageAction(!1)):__canRender?(renderPage(document.URL),togglePageAction(!1)):togglePageAction(!0)}})(function(){var n="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this||{},t=n._,r=Array.prototype,i=Object.prototype,s="undefined"!=typeof Symbol?Symbol.prototype:null,o=r.push,c=r.slice,p=i.toString,u=i.hasOwnProperty,e=Array.isArray,a=Object.keys,l=Object.create,f=function(){},h=function(n){return n instanceof h?n:this instanceof h?void(this._wrapped=n):new h(n)};"undefined"==typeof exports||exports.nodeType?n._=h:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=h),exports._=h),h.VERSION="1.9.1";var d,v=function(o,u,n){if(void 0===u)return o;switch(null==n?3:n){case 1:return function(n){return o.call(u,n)};case 3:return function(n,t,e){return o.call(u,n,t,e)};case 4:return function(n,t,e,r){return o.call(u,n,t,e,r)}}return function(){return o.apply(u,arguments)}},m=function(n,t,e){return h.iteratee!==d?h.iteratee(n,t):null==n?h.identity:h.isFunction(n)?v(n,t,e):h.isObject(n)&&!h.isArray(n)?h.matcher(n):h.property(n)};h.iteratee=d=function(n,t){return m(n,t,1/0)};var g=function(o,u){return u=null==u?o.length-1:+u,function(){for(var n=Math.max(arguments.length-u,0),t=Array(n),e=0;e<n;e++)t[e]=arguments[e+u];switch(u){case 0:return o.call(this,t);case 1:return o.call(this,arguments[0],t);case 2:return o.call(this,arguments[0],arguments[1],t)}var r=Array(u+1);for(e=0;e<u;e++)r[e]=arguments[e];return r[u]=t,o.apply(this,r)}},y=function(n){if(!h.isObject(n))return{};if(l)return l(n);f.prototype=n;var t=new f;return f.prototype=null,t},b=function(t){return function(n){return null==n?void 0:n[t]}},w=function(n,t){return null!=n&&u.call(n,t)},x=function(n,t){for(var e=t.length,r=0;r<e;r++){if(null==n)return;n=n[t[r]]}return e?n:void 0},j=Math.pow(2,53)-1,_=b("length"),A=function(n){var t=_(n);return"number"==typeof t&&0<=t&&t<=j};h.each=h.forEach=function(n,t,e){var r,o;if(t=v(t,e),A(n))for(r=0,o=n.length;r<o;r++)t(n[r],r,n);else{var u=h.keys(n);for(r=0,o=u.length;r<o;r++)t(n[u[r]],u[r],n)}return n},h.map=h.collect=function(n,t,e){t=m(t,e);for(var r=!A(n)&&h.keys(n),o=(r||n).length,u=Array(o),i=0;i<o;i++){var a=r?r[i]:i;u[i]=t(n[a],a,n)}return u};var E=function(c){return function(n,t,e,r){var o=3<=arguments.length;return function(n,t,e,r){var o=!A(n)&&h.keys(n),u=(o||n).length,i=0<c?0:u-1;for(r||(e=n[o?o[i]:i],i+=c);0<=i&&i<u;i+=c){var a=o?o[i]:i;e=t(e,n[a],a,n)}return e}(n,v(t,r,4),e,o)}};h.reduce=h.foldl=h.inject=E(1),h.reduceRight=h.foldr=E(-1),h.find=h.detect=function(n,t,e){var r=(A(n)?h.findIndex:h.findKey)(n,t,e);if(void 0!==r&&-1!==r)return n[r]},h.filter=h.select=function(n,r,t){var o=[];return r=m(r,t),h.each(n,function(n,t,e){r(n,t,e)&&o.push(n)}),o},h.reject=function(n,t,e){return h.filter(n,h.negate(m(t)),e)},h.every=h.all=function(n,t,e){t=m(t,e);for(var r=!A(n)&&h.keys(n),o=(r||n).length,u=0;u<o;u++){var i=r?r[u]:u;if(!t(n[i],i,n))return!1}return!0},h.some=h.any=function(n,t,e){t=m(t,e);for(var r=!A(n)&&h.keys(n),o=(r||n).length,u=0;u<o;u++){var i=r?r[u]:u;if(t(n[i],i,n))return!0}return!1},h.contains=h.includes=h.include=function(n,t,e,r){return A(n)||(n=h.values(n)),("number"!=typeof e||r)&&(e=0),0<=h.indexOf(n,t,e)},h.invoke=g(function(n,e,r){var o,u;return h.isFunction(e)?u=e:h.isArray(e)&&(o=e.slice(0,-1),e=e[e.length-1]),h.map(n,function(n){var t=u;if(!t){if(o&&o.length&&(n=x(n,o)),null==n)return;t=n[e]}return null==t?t:t.apply(n,r)})}),h.pluck=function(n,t){return h.map(n,h.property(t))},h.where=function(n,t){return h.filter(n,h.matcher(t))},h.findWhere=function(n,t){return h.find(n,h.matcher(t))},h.max=function(n,r,t){var e,o,u=-1/0,i=-1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n)for(var a=0,c=(n=A(n)?n:h.values(n)).length;a<c;a++)null!=(e=n[a])&&u<e&&(u=e);else r=m(r,t),h.each(n,function(n,t,e){o=r(n,t,e),(i<o||o===-1/0&&u===-1/0)&&(u=n,i=o)});return u},h.min=function(n,r,t){var e,o,u=1/0,i=1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n)for(var a=0,c=(n=A(n)?n:h.values(n)).length;a<c;a++)null!=(e=n[a])&&e<u&&(u=e);else r=m(r,t),h.each(n,function(n,t,e){((o=r(n,t,e))<i||o===1/0&&u===1/0)&&(u=n,i=o)});return u},h.shuffle=function(n){return h.sample(n,1/0)},h.sample=function(n,t,e){if(null==t||e)return A(n)||(n=h.values(n)),n[h.random(n.length-1)];var r=A(n)?h.clone(n):h.values(n),o=_(r);t=Math.max(Math.min(t,o),0);for(var u=o-1,i=0;i<t;i++){var a=h.random(i,u),c=r[i];r[i]=r[a],r[a]=c}return r.slice(0,t)},h.sortBy=function(n,r,t){var o=0;return r=m(r,t),h.pluck(h.map(n,function(n,t,e){return{value:n,index:o++,criteria:r(n,t,e)}}).sort(function(n,t){var e=n.criteria,r=t.criteria;if(e!==r){if(r<e||void 0===e)return 1;if(e<r||void 0===r)return-1}return n.index-t.index}),"value")};var M=function(i,t){return function(r,o,n){var u=t?[[],[]]:{};return o=m(o,n),h.each(r,function(n,t){var e=o(n,t,r);i(u,n,e)}),u}};h.groupBy=M(function(n,t,e){w(n,e)?n[e].push(t):n[e]=[t]}),h.indexBy=M(function(n,t,e){n[e]=t}),h.countBy=M(function(n,t,e){w(n,e)?n[e]++:n[e]=1});var k=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;h.toArray=function(n){return n?h.isArray(n)?c.call(n):h.isString(n)?n.match(k):A(n)?h.map(n,h.identity):h.values(n):[]},h.size=function(n){return null==n?0:A(n)?n.length:h.keys(n).length},h.partition=M(function(n,t,e){n[e?0:1].push(t)},!0),h.first=h.head=h.take=function(n,t,e){return null==n||n.length<1?null==t?void 0:[]:null==t||e?n[0]:h.initial(n,n.length-t)},h.initial=function(n,t,e){return c.call(n,0,Math.max(0,n.length-(null==t||e?1:t)))},h.last=function(n,t,e){return null==n||n.length<1?null==t?void 0:[]:null==t||e?n[n.length-1]:h.rest(n,Math.max(0,n.length-t))},h.rest=h.tail=h.drop=function(n,t,e){return c.call(n,null==t||e?1:t)},h.compact=function(n){return h.filter(n,Boolean)};var O=function(n,t,e,r){for(var o=(r=r||[]).length,u=0,i=_(n);u<i;u++){var a=n[u];if(A(a)&&(h.isArray(a)||h.isArguments(a)))if(t)for(var c=0,l=a.length;c<l;)r[o++]=a[c++];else O(a,t,e,r),o=r.length;else e||(r[o++]=a)}return r};h.flatten=function(n,t){return O(n,t,!1)},h.without=g(function(n,t){return h.difference(n,t)}),h.uniq=h.unique=function(n,t,e,r){h.isBoolean(t)||(r=e,e=t,t=!1),null!=e&&(e=m(e,r));for(var o=[],u=[],i=0,a=_(n);i<a;i++){var c=n[i],l=e?e(c,i,n):c;t&&!e?(i&&u===l||o.push(c),u=l):e?h.contains(u,l)||(u.push(l),o.push(c)):h.contains(o,c)||o.push(c)}return o},h.union=g(function(n){return h.uniq(O(n,!0,!0))}),h.intersection=function(n){for(var t=[],e=arguments.length,r=0,o=_(n);r<o;r++){var u=n[r];if(!h.contains(t,u)){var i;for(i=1;i<e&&h.contains(arguments[i],u);i++);i===e&&t.push(u)}}return t},h.difference=g(function(n,t){return t=O(t,!0,!0),h.filter(n,function(n){return!h.contains(t,n)})}),h.unzip=function(n){for(var t=n&&h.max(n,_).length||0,e=Array(t),r=0;r<t;r++)e[r]=h.pluck(n,r);return e},h.zip=g(h.unzip),h.object=function(n,t){for(var e={},r=0,o=_(n);r<o;r++)t?e[n[r]]=t[r]:e[n[r][0]]=n[r][1];return e};var S=function(u){return function(n,t,e){t=m(t,e);for(var r=_(n),o=0<u?0:r-1;0<=o&&o<r;o+=u)if(t(n[o],o,n))return o;return-1}};h.findIndex=S(1),h.findLastIndex=S(-1),h.sortedIndex=function(n,t,e,r){for(var o=(e=m(e,r,1))(t),u=0,i=_(n);u<i;){var a=Math.floor((u+i)/2);e(n[a])<o?u=a+1:i=a}return u};var T=function(u,i,a){return function(n,t,e){var r=0,o=_(n);if("number"==typeof e)0<u?r=0<=e?e:Math.max(e+o,r):o=0<=e?Math.min(e+1,o):e+o+1;else if(a&&e&&o)return n[e=a(n,t)]===t?e:-1;if(t!=t)return 0<=(e=i(c.call(n,r,o),h.isNaN))?e+r:-1;for(e=0<u?r:o-1;0<=e&&e<o;e+=u)if(n[e]===t)return e;return-1}};h.indexOf=T(1,h.findIndex,h.sortedIndex),h.lastIndexOf=T(-1,h.findLastIndex),h.range=function(n,t,e){null==t&&(t=n||0,n=0),e||(e=t<n?-1:1);for(var r=Math.max(Math.ceil((t-n)/e),0),o=Array(r),u=0;u<r;u++,n+=e)o[u]=n;return o},h.chunk=function(n,t){if(null==t||t<1)return[];for(var e=[],r=0,o=n.length;r<o;)e.push(c.call(n,r,r+=t));return e};var N=function(n,t,e,r,o){if(!(r instanceof t))return n.apply(e,o);var u=y(n.prototype),i=n.apply(u,o);return h.isObject(i)?i:u};h.bind=g(function(t,e,r){if(!h.isFunction(t))throw new TypeError("Bind must be called on a function");var o=g(function(n){return N(t,o,e,this,r.concat(n))});return o}),h.partial=g(function(o,u){var i=h.partial.placeholder,a=function(){for(var n=0,t=u.length,e=Array(t),r=0;r<t;r++)e[r]=u[r]===i?arguments[n++]:u[r];for(;n<arguments.length;)e.push(arguments[n++]);return N(o,a,this,this,e)};return a}),(h.partial.placeholder=h).bindAll=g(function(n,t){var e=(t=O(t,!1,!1)).length;if(e<1)throw new Error("bindAll must be passed function names");for(;e--;){var r=t[e];n[r]=h.bind(n[r],n)}}),h.memoize=function(r,o){var u=function(n){var t=u.cache,e=""+(o?o.apply(this,arguments):n);return w(t,e)||(t[e]=r.apply(this,arguments)),t[e]};return u.cache={},u},h.delay=g(function(n,t,e){return setTimeout(function(){return n.apply(null,e)},t)}),h.defer=h.partial(h.delay,h,1),h.throttle=function(e,r,o){var u,i,a,c,l=0;o||(o={});var f=function(){l=!1===o.leading?0:h.now(),u=null,c=e.apply(i,a),u||(i=a=null)},n=function(){var n=h.now();l||!1!==o.leading||(l=n);var t=r-(n-l);return i=this,a=arguments,t<=0||r<t?(u&&(clearTimeout(u),u=null),l=n,c=e.apply(i,a),u||(i=a=null)):u||!1===o.trailing||(u=setTimeout(f,t)),c};return n.cancel=function(){clearTimeout(u),l=0,u=i=a=null},n},h.debounce=function(e,r,o){var u,i,a=function(n,t){u=null,t&&(i=e.apply(n,t))},n=g(function(n){if(u&&clearTimeout(u),o){var t=!u;u=setTimeout(a,r),t&&(i=e.apply(this,n))}else u=h.delay(a,r,this,n);return i});return n.cancel=function(){clearTimeout(u),u=null},n},h.wrap=function(n,t){return h.partial(t,n)},h.negate=function(n){return function(){return!n.apply(this,arguments)}},h.compose=function(){var e=arguments,r=e.length-1;return function(){for(var n=r,t=e[r].apply(this,arguments);n--;)t=e[n].call(this,t);return t}},h.after=function(n,t){return function(){if(--n<1)return t.apply(this,arguments)}},h.before=function(n,t){var e;return function(){return 0<--n&&(e=t.apply(this,arguments)),n<=1&&(t=null),e}},h.once=h.partial(h.before,2),h.restArguments=g;var F=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],I=function(n,t){var e=D.length,r=n.constructor,o=h.isFunction(r)&&r.prototype||i,u="constructor";for(w(n,u)&&!h.contains(t,u)&&t.push(u);e--;)(u=D[e])in n&&n[u]!==o[u]&&!h.contains(t,u)&&t.push(u)};h.keys=function(n){if(!h.isObject(n))return[];if(a)return a(n);var t=[];for(var e in n)w(n,e)&&t.push(e);return F&&I(n,t),t},h.allKeys=function(n){if(!h.isObject(n))return[];var t=[];for(var e in n)t.push(e);return F&&I(n,t),t},h.values=function(n){for(var t=h.keys(n),e=t.length,r=Array(e),o=0;o<e;o++)r[o]=n[t[o]];return r},h.mapObject=function(n,t,e){t=m(t,e);for(var r=h.keys(n),o=r.length,u={},i=0;i<o;i++){var a=r[i];u[a]=t(n[a],a,n)}return u},h.pairs=function(n){for(var t=h.keys(n),e=t.length,r=Array(e),o=0;o<e;o++)r[o]=[t[o],n[t[o]]];return r},h.invert=function(n){for(var t={},e=h.keys(n),r=0,o=e.length;r<o;r++)t[n[e[r]]]=e[r];return t},h.functions=h.methods=function(n){var t=[];for(var e in n)h.isFunction(n[e])&&t.push(e);return t.sort()};var R=function(c,l){return function(n){var t=arguments.length;if(l&&(n=Object(n)),t<2||null==n)return n;for(var e=1;e<t;e++)for(var r=arguments[e],o=c(r),u=o.length,i=0;i<u;i++){var a=o[i];l&&void 0!==n[a]||(n[a]=r[a])}return n}};h.extend=R(h.allKeys),h.extendOwn=h.assign=R(h.keys),h.findKey=function(n,t,e){t=m(t,e);for(var r,o=h.keys(n),u=0,i=o.length;u<i;u++)if(t(n[r=o[u]],r,n))return r};var B,L,P=function(n,t,e){return t in e};h.pick=g(function(n,t){var e={},r=t[0];if(null==n)return e;h.isFunction(r)?(1<t.length&&(r=v(r,t[1])),t=h.allKeys(n)):(r=P,t=O(t,!1,!1),n=Object(n));for(var o=0,u=t.length;o<u;o++){var i=t[o],a=n[i];r(a,i,n)&&(e[i]=a)}return e}),h.omit=g(function(n,e){var t,r=e[0];return h.isFunction(r)?(r=h.negate(r),1<e.length&&(t=e[1])):(e=h.map(O(e,!1,!1),String),r=function(n,t){return!h.contains(e,t)}),h.pick(n,r,t)}),h.defaults=R(h.allKeys,!0),h.create=function(n,t){var e=y(n);return t&&h.extendOwn(e,t),e},h.clone=function(n){return h.isObject(n)?h.isArray(n)?n.slice():h.extend({},n):n},h.tap=function(n,t){return t(n),n},h.isMatch=function(n,t){var e=h.keys(t),r=e.length;if(null==n)return!r;for(var o=Object(n),u=0;u<r;u++){var i=e[u];if(t[i]!==o[i]||!(i in o))return!1}return!0},B=function(n,t,e,r){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return!1;if(n!=n)return t!=t;var o=typeof n;return("function"===o||"object"===o||"object"==typeof t)&&L(n,t,e,r)},L=function(n,t,e,r){n instanceof h&&(n=n._wrapped),t instanceof h&&(t=t._wrapped);var o=p.call(n);if(o!==p.call(t))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+n==""+t;case"[object Number]":return+n!=+n?+t!=+t:0==+n?1/+n==1/t:+n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object Symbol]":return s.valueOf.call(n)===s.valueOf.call(t)}var u="[object Array]"===o;if(!u){if("object"!=typeof n||"object"!=typeof t)return!1;var i=n.constructor,a=t.constructor;if(i!==a&&!(h.isFunction(i)&&i instanceof i&&h.isFunction(a)&&a instanceof a)&&"constructor"in n&&"constructor"in t)return!1}r=r||[];for(var c=(e=e||[]).length;c--;)if(e[c]===n)return r[c]===t;if(e.push(n),r.push(t),u){if((c=n.length)!==t.length)return!1;for(;c--;)if(!B(n[c],t[c],e,r))return!1}else{var l,f=h.keys(n);if(c=f.length,h.keys(t).length!==c)return!1;for(;c--;)if(l=f[c],!w(t,l)||!B(n[l],t[l],e,r))return!1}return e.pop(),r.pop(),!0},h.isEqual=function(n,t){return B(n,t)},h.isEmpty=function(n){return null==n||(A(n)&&(h.isArray(n)||h.isString(n)||h.isArguments(n))?0===n.length:0===h.keys(n).length)},h.isElement=function(n){return!(!n||1!==n.nodeType)},h.isArray=e||function(n){return"[object Array]"===p.call(n)},h.isObject=function(n){var t=typeof n;return"function"===t||"object"===t&&!!n},h.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(t){h["is"+t]=function(n){return p.call(n)==="[object "+t+"]"}}),h.isArguments(arguments)||(h.isArguments=function(n){return w(n,"callee")});var C=n.document&&n.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof C&&(h.isFunction=function(n){return"function"==typeof n||!1}),h.isFinite=function(n){return!h.isSymbol(n)&&isFinite(n)&&!isNaN(parseFloat(n))},h.isNaN=function(n){return h.isNumber(n)&&isNaN(n)},h.isBoolean=function(n){return!0===n||!1===n||"[object Boolean]"===p.call(n)},h.isNull=function(n){return null===n},h.isUndefined=function(n){return void 0===n},h.has=function(n,t){if(!h.isArray(t))return w(n,t);for(var e=t.length,r=0;r<e;r++){var o=t[r];if(null==n||!u.call(n,o))return!1;n=n[o]}return!!e},h.noConflict=function(){return n._=t,this},h.identity=function(n){return n},h.constant=function(n){return function(){return n}},h.noop=function(){},h.property=function(t){return h.isArray(t)?function(n){return x(n,t)}:b(t)},h.propertyOf=function(t){return null==t?function(){}:function(n){return h.isArray(n)?x(t,n):t[n]}},h.matcher=h.matches=function(t){return t=h.extendOwn({},t),function(n){return h.isMatch(n,t)}},h.times=function(n,t,e){var r=Array(Math.max(0,n));t=v(t,e,1);for(var o=0;o<n;o++)r[o]=t(o);return r},h.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))},h.now=Date.now||function(){return(new Date).getTime()};var X={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},q=h.invert(X),K=function(t){var e=function(n){return t[n]},n="(?:"+h.keys(t).join("|")+")",r=RegExp(n),o=RegExp(n,"g");return function(n){return n=null==n?"":""+n,r.test(n)?n.replace(o,e):n}};h.escape=K(X),h.unescape=K(q),h.result=function(n,t,e){h.isArray(t)||(t=[t]);var r=t.length;if(!r)return h.isFunction(e)?e.call(n):e;for(var o=0;o<r;o++){var u=null==n?void 0:n[t[o]];void 0===u&&(u=e,o=r),n=h.isFunction(u)?u.call(n):u}return n};var z=0;h.uniqueId=function(n){var t=++z+"";return n?n+t:t},h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var U=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},W=/\\|'|\r|\n|\u2028|\u2029/g,G=function(n){return"\\"+H[n]};h.template=function(u,n,t){!n&&t&&(n=t),n=h.defaults({},n,h.templateSettings);var e,r=RegExp([(n.escape||U).source,(n.interpolate||U).source,(n.evaluate||U).source].join("|")+"|$","g"),i=0,a="__p+='";u.replace(r,function(n,t,e,r,o){return a+=u.slice(i,o).replace(W,G),i=o+n.length,t?a+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":e?a+="'+\n((__t=("+e+"))==null?'':__t)+\n'":r&&(a+="';\n"+r+"\n__p+='"),n}),a+="';\n",n.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(n.variable||"obj","_",a)}catch(n){throw n.source=a,n}var o=function(n){return e.call(this,n,h)},c=n.variable||"obj";return o.source="function("+c+"){\n"+a+"}",o},h.chain=function(n){var t=h(n);return t._chain=!0,t};var J=function(n,t){return n._chain?h(t).chain():t};h.mixin=function(e){return h.each(h.functions(e),function(n){var t=h[n]=e[n];h.prototype[n]=function(){var n=[this._wrapped];return o.apply(n,arguments),J(this,t.apply(h,n))}}),h},h.mixin(h),h.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=r[t];h.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],J(this,n)}}),h.each(["concat","join","slice"],function(n){var t=r[n];h.prototype[n]=function(){return J(this,t.apply(this._wrapped,arguments))}}),h.prototype.value=function(){return this._wrapped},h.prototype.valueOf=h.prototype.toJSON=h.prototype.value,h.prototype.toString=function(){return String(this._wrapped)},"function"==typeof define&&define.amd&&define("underscore",[],function(){return h})}());