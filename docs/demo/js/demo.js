var get=function(e,t,n){return new Promise(function(s,o){var r=new XMLHttpRequest;"json"===t&&(r.responseType=t),n&&(e="https://allorigins.me/get?method=raw&url="+encodeURIComponent(e)),r.open("GET",e),r.onload=function(){200===r.status?s("json"===t?r.response:r.responseText):o(Error(r.statusText+" ("+r.status+")"))},r.onerror=function(){o(Error("Network Error"))},r.send()})},chrome={extension:{getURL:function(e){return e}},runtime:{sendMessage:function(e,t){e.proxy=!1!==e.proxy;var n="xml";"msg.jsonrequest"===e.action&&(n="json"),get(e.url,n,!!e.proxy).then(function(e){t({success:!0,message:e})}).catch(function(e){t({success:!1,message:e.message})})}}};function debounce(e,t,n){var s;return function(){var o=this,r=arguments,a=n&&!s;clearTimeout(s),s=setTimeout(function(){s=null,n||e.apply(o,r)},t),a&&e.apply(o,r)}}$(function(){$("form").on("submit",function(){return!1}),$("#iati-org-popup body").on("click","a.list-group-item",function(){return chrome.runtime.sendMessage({action:"msg.opentab",url:$(this).attr("href")}),!1});$("#org-file-name").on("keyup",debounce(function(){var e=$(this).val();""!==e?($(".list-group").html('<div id="loading-spinner"><div></div></div>'),chrome.runtime.sendMessage({action:"msg.jsonrequest",url:"https://iatiregistry.org/api/3/action/package_search?fq=extras_filetype:organisation&qf=title&q="+e},function(e){var t=e.message.result,n=[];t.count>0&&t.results.forEach(function(e){n.push('<a data-dataset-name="'+e.name+'" data-download-url="'+e.resources[0].url+'" href="https://iatiregistry.org/dataset/'+e.name+'" class="list-group-item pwyf-org-viz-btn"><span class="badge"><span class="fas fa-link"></span></span> '+e.title+"</a>")}),$(".list-group").html(n.join(""))})):$(".list-group").html("")},500))});